#!/usr/bin/env python
# coding: utf-8

# <img src=https://kto-ozvuchival.ru/wp-content/uploads/2017/12/kto-ozvuchivaet-toni-starka-na-russkom-800x500.jpg>
# <hr style="border: 10px solid green;" />
# 
# ## <span style="color:green">–§–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π<span>
# 
# –î–µ–Ω–∏—Å, —Å–ø–∞—Å–∏–±–æ –∑–∞ –¥–æ—Ä–∞–±–æ—Ç–∫–∏ü§ù
# 
# –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —Ç—ã —Ö–æ—Ä–æ—à–æ —Ä–∞–∑–æ–±—Ä–∞–ª—Å—è –≤ —Ç–µ–º–µ, –æ—Å—Ç–∞–ª—å–Ω–æ–µ —ç—Ç–æ –æ–ø—ã—Ç, –µ–≥–æ –Ω–∏ –ø—Ä–∏—à–∏—Ç—å, –Ω–∏ –ø—Ä–æ—á–∏—Ç–∞—Ç—å. –ò–∑—É—á–∞–π, —ç–∫—Å–ø—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π –∏ —É —Ç–µ–±—è –≤—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è.
# 
# –ü–æ–∑–¥—Ä–∞–≤–ª—è—é, –ø—Ä–æ–µ–∫—Ç –ø—Ä–∏–Ω—è—Çüëç
# 
# –ñ–µ–ª–∞—é —É—Å–ø–µ—Ö–æ–≤ –≤ –æ–±—É—á–µ–Ω–∏–∏. –°–∫–æ—Ä–æ —É —Ç–µ–±—è –≤—ã–ø—É—Å–∫–Ω–æ–π –ø—Ä–æ–µ–∫—Ç, –æ—Ç–¥–æ—Ö–Ω–∏ –∏ –Ω–∞–±–µ—Ä–∏—Å—å —Å–∏–ª - —ç—Ç–æ –±—É–¥–µ—Ç –Ω–∞—Å—ã—â–µ–Ω–Ω—ã–π —Å–ø—Ä–∏–Ω—Çüí™

# <hr style="border: 2px solid green;" />
# 
# ## –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–≤–µ—Ä–∞
# 
# –î–µ–Ω–∏—Å, –ø—Ä–∏–≤–µ—Ç! 
# 
# ü§ö–ú–µ–Ω—è –∑–æ–≤—É—Ç, –û–ª–µ–≥ –Æ—Ä—å–µ–≤, —è –±—É–¥—É –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç. –ï—Å–ª–∏ –Ω–µ –ø—Ä–æ—Ç–∏–≤, —è –±—É–¥—É –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —Ç–µ–±–µ –Ω–∞ _–¢–´_ . –ï—Å–ª–∏ —ç—Ç–æ –Ω–µ–ø—Ä–∏–µ–º–ª–µ–º–æ, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞–ø–∏—à–∏ –º–Ω–µ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö - –º—ã –ø—Ä–µ–π–¥–µ–º –Ω–∞ _–í–´_ .
# 
# ü§ù–°–ø–∞—Å–∏–±–æ, —á—Ç–æ —Å–¥–∞–ª –ø—Ä–æ–µ–∫—Ç –≤–æ–≤—Ä–µ–º—è. –¢–æ–±–æ–π –ø—Ä–æ–¥–µ–ª–∞–Ω–∞ –±–æ–ª—å—à–∞—è —Ä–∞–±–æ—Ç–∞, –º–æ–ª–æ–¥–µ—Ü! 
# 
# ‚úèÔ∏è–í —ç—Ç–æ–π —Ç–µ—Ç—Ä–∞–¥–∫–µ —Ç—ã –Ω–∞–π–¥–µ—à—å –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏.
# 
# –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –±—É–¥—É—Ç –≤—ã–¥–µ–ª–µ–Ω—ã:
# 
# <div style="border:solid green 2px; padding: 20px"> <b>–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞</b><br>
#     –ë–µ–∑—É–ø—Ä–µ—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞</div>       
# <br>
# <div style="border:solid orange 2px; padding: 20px"> <b>–ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å</b><br>
#     –ù–∏—á–µ–≥–æ –¥–æ—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–µ –Ω–∞–¥–æ, –¥–∞–Ω–Ω—ã–µ –ø—É–Ω–∫—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –Ω–æ –µ—Å—Ç—å —Å–ø–æ—Å–æ–±—ã —É–ª—É—á—à–∏—Ç—å. –ù–µ—Å–∫–æ–ª—å–∫–æ —Ç–∞–∫–∏—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –¥–æ–ø—É—Å—Ç–∏–º—ã, –Ω–æ –±–æ–ª–µ–µ - –ø—Ä–∏–¥–µ—Ç—Å—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å. –ë–æ–ª—å—à–æ–µ –∫–æ–ª-–≤–æ –º–µ–ª–∫–∏—Ö –∑–∞–º–µ—á–∞–Ω–∏–π –∏ –ø–æ–º–∞—Ä–æ–∫ —Å–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –Ω–∞ –æ–±—â–µ–º –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–∏ –æ—Ç —Ä–∞–±–æ—Ç—ã.</div>   
# <br>
# <div style="border:solid red 2px; padding: 20px"> <b>–ß—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å</b><br>
#     –¢–∞–∫–∏–µ –ø—É–Ω–∫—Ç—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å, —á—Ç–æ–±—ã —è —Å–º–æ–≥ –ø—Ä–∏–Ω—è—Ç—å –ø—Ä–æ–µ–∫—Ç.</div>
#  
# –ù–µ —É–¥–∞–ª—è–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, —Ç–∞–∫ –±—É–¥–µ–º —Å–ª–µ–¥–∏—Ç—å –∑–∞ –¥–∏–Ω–∞–º–∏–∫–æ–π üìà
#    
# –î–∞–≤–∞–π –±—É–¥–µ–º –≤ –¥–∏–∞–ª–æ–≥–µ - –æ—Å–Ω–æ–≤–Ω—ã–µ —Ü–µ–ª–∏ –≤ –¥–∏–∞–ª–æ–≥–µ:
# - –æ–±–º–µ–Ω –æ–ø—ã—Ç–æ–º (–¥–∞ —è —Ç–æ–∂–µ —É—á—É—Å—å —É —Å—Ç—É–¥–µ–Ω—Ç–æ–≤üë®‚Äçüéì)
# - –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –µ—â–µ –ª—É—á—à–µ
# - –ø–æ–º–æ—á—å —Ç–µ–±–µ —Å—Ç–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–º
# 
# –ü–æ—ç—Ç–æ–º—É —á—Ç–æ–±—ã –º–Ω–µ –ø—Ä–æ—â–µ –±—ã–ª–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ, –∞ —Ç–µ–±–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å —Ä–µ–≤—å—é, –æ—Å—Ç–∞–≤–ª—è–π —Å–≤–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –≤—ã–¥–µ–ª—è–π –∏—Ö. 
#     
# <div class="alert alert-info" style="border:solid blue 2px; padding: 20px"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ù–∞–ø—Ä–∏–º–µ—Ä, –≤–æ—Ç —Ç–∞–∫.</div>
#    
# –ü–æ–µ—Ö–∞–ª–∏! :)
# 
# <hr style="border: 2px solid green;" />

# <div class="alert alert-info" style="border:solid blue 2px; padding: 20px"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é, –û–ª–µ–≥! –°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –ø–æ—è—Å–Ω–µ–Ω–∏—è. –ß—Ç–æ-—Ç–æ —Å—Ç–∞–ª–æ –ø–æ–Ω—è—Ç–Ω–µ–π, —á—Ç–æ-—Ç–æ —É–∑–Ω–∞–ª –Ω–æ–≤–æ–µ. </div>

# ### –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
# –°–µ—Ç—å —Ñ–∏—Ç–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä–æ–≤ ¬´–ö—É–ª—å—Ç—É—Ä–∏—Å—Ç-–¥–∞—Ç–∞—Å–∞–µ–Ω—Ç–∏—Å—Ç¬ª —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.
# –ß—Ç–æ–±—ã –±–æ—Ä–æ—Ç—å—Å—è —Å –æ—Ç—Ç–æ–∫–æ–º, –æ—Ç–¥–µ–ª –ø–æ —Ä–∞–±–æ—Ç–µ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ ¬´–ö—É–ª—å—Ç—É—Ä–∏—Å—Ç–∞-–¥–∞—Ç–∞—Å–∞–µ–Ω—Ç–∏—Å—Ç–∞¬ª –ø–µ—Ä–µ–≤—ë–ª –≤ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π –≤–∏–¥ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∞–Ω–∫–µ—Ç. –í–∞—à–∞ –∑–∞–¥–∞—á–∞ ‚Äî –ø—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π –ø–æ —É–¥–µ—Ä–∂–∞–Ω–∏—é –∫–ª–∏–µ–Ω—Ç–æ–≤.

# ### –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ <a id='contents'></a>
# 
# 1. [–®–∞–≥ 1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ](#step1)<br>
#     <br>
# 2. [–®–∞–≥ 2. –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö (EDA)](#step2)
#     * [–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è](#step2.1)
#     * [–°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –¥–≤—É—Ö –≥—Ä—É–ø–ø–∞—Ö ‚Äî —Ç–µ—Ö, –∫—Ç–æ —É—à–µ–ª –≤ –æ—Ç—Ç–æ–∫ –∏ —Ç–µ—Ö, –∫—Ç–æ –æ—Å—Ç–∞–ª—Å—è](#step2.2)
#     * [–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å—Ç–æ–ª–±—á–∞—Ç—ã—Ö –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —É—à—ë–ª (–æ—Ç—Ç–æ–∫) –∏ —Ç–µ—Ö, –∫—Ç–æ –æ—Å—Ç–∞–ª—Å—è (–Ω–µ –ø–æ–ø–∞–ª–∏ –≤ –æ—Ç—Ç–æ–∫)](#step2.3) 
#     * [–ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏](#step2.4)
#     * [–í—ã–≤–æ–¥](#step2.5)<br>
#     <br>
# 3. [–®–∞–≥ 3. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç—Ç–æ–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤](#step3)
#     * [–†–∞–∑–±–∏–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—É—é –≤—ã–±–æ—Ä–∫–∏](#step3.1)
#     * [–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ train-–≤—ã–±–æ—Ä–∫–µ –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–µ–π –∏ —Å–ª—É—á–∞–π–Ω—ã–º –ª–µ—Å–æ–º](#step3.2)
#     * [–û—Ü–µ–Ω–∫–∞ –º–µ—Ç—Ä–∏–∫ accuracy, precision –∏ recall –¥–ª—è –æ–±–µ–∏—Ö –º–æ–¥–µ–ª–µ–π –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π](#step3.3)
#     * [–í—ã–≤–æ–¥](#step3.4)<br>
#     <br>
# 4. [–®–∞–≥ 4. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤](#step4)
#     * [–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö](#step4.1)
#     * [–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π —Ñ—É–Ω–∫—Ü–∏–µ–π linkage() –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º—ã ](#step4.2)
#     * [–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ K-Means –∏ –ø—Ä–æ–≥–Ω–æ–∑ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤](#step4.3)
#     * [–ò–∑—É—á–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤. –•–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏](#step4.4)
#     * [–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤](#step4.5)
#     * [–†–∞—Å—á–µ—Ç –¥–æ–ª–∏ –æ—Ç—Ç–æ–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞. –û—Ç–ª–∏—á–∞—é—Ç—Å—è –ª–∏ –æ–Ω–∏ –ø–æ –¥–æ–ª–µ –æ—Ç—Ç–æ–∫–∞? –ö–∞–∫–∏–µ –∫–ª–∞—Å—Ç–µ—Ä—ã —Å–∫–ª–æ–Ω–Ω—ã –∫ –æ—Ç—Ç–æ–∫—É, –∞ –∫–∞–∫–∏–µ ‚Äî –Ω–∞–¥—ë–∂–Ω—ã?](#step4.6) <br>
#     <br>
# 5. [–®–∞–≥ 5. –í—ã–≤–æ–¥—ã –∏ –±–∞–∑–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏](#step5)

# <div class = "alert alert-block alert-info">
# –ü—Ä–∏–≤–µ—Ç) —è –ø—Ä–∏–º–µ–Ω–∏–ª –≤ —Ä–∞–±–æ—Ç–µ RandomizedSearchCV –∏ GridSearchCV, –ø–æ—ç—Ç–æ–º—É –≤—Å—è —Ç–µ—Ç—Ä–∞–¥–∫–∞ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç)
# –ê –µ—â–µ —è –ø—ã—Ç–∞–ª—Å—è –¥–æ–±–∏—Ç—å—Å—è –ø–æ–ª–Ω–æ–π –ø–æ–≤—Ç–æ—Ä—è–µ–º–æ—Å—Ç–∏ KMeans, –≤—Ä–æ–¥–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å, –Ω–æ –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π churn rate –ø–æ –ø—è—Ç–∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã–º –∫–ª–∞—Å—Ç–µ—Ä–∞–º: <br>
#     0.61, 0.03, 0.10, 0.48,	0.15
# </div>

# <div style="border:solid green 2px; padding: 20px"> <b>–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞</b><br>
# üëç –î–ª—è Kmeans –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä <code>random_state</code></div>   

# <div class="alert alert-info" style="border:solid blue 2px; padding: 20px"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –°–Ω–∞—á–∞–ª–∞ —Ç–∞–∫ –∏ —Å–¥–µ–ª–∞–ª, –Ω–æ –µ—Å–ª–∏ —Ç–æ–ª—å–∫–æ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, —Ç–æ –º–µ–Ω—è–ª–∏—Å—å –∫–ª–∞—Å—Ç–µ—Ä—ã –ø–æ—Å—Ç–æ—è–Ω–Ω–æ. –Ø —Ç–∞–∫ –ø–æ–Ω—è–ª, —á—Ç–æ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å –∫–∞–∫–æ–π-—Ç–æ –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å—é –≤—ã–±–∏—Ä–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ —Ü–µ–Ω—Ç—Ä–æ–∏–¥—ã –∫–ª–∞—Å—Ç–µ—Ä–æ–≤, –ø–æ—ç—Ç–æ–º—É –∫–ª–∞—Å—Ç–µ—Ä—ã –º–µ–Ω—è–∏—Å—å. –ö–∞–∫ –º–∏–Ω–∏–º—É–º –∏—Ö –ø–æ—Ä—è–¥–æ–∫. </div>

# <div style="border:solid green 2px; padding: 20px"> <b>–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 2</b><br>üëç–î–∞, –≤—Å–µ –≤–µ—Ä–Ω–æ, –µ—Å–ª–∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å random_state, —Ç–æ —Ä–∞—Å—á–µ—Ç—ã –±—É–¥—É—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω—ã, –∞ –Ω–æ–º–µ—Ä–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –≤—ã–±–∏—Ä–∞—é—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ</div> 

# ### –®–∞–≥ 1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö <a id='step1'></a>
# [–ö —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é](#contents)

# –£—Å—Ç–∞–Ω–æ–≤–∏–º –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é seaborn –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è displot:

# –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Kernel (–ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ —É –º–µ–Ω—è —Ç–æ–ª—å–∫–æ —Ç–∞–∫ –∑–∞—Ä–∞–±–æ—Ç–∞–ª–æ))

# In[1]:


get_ipython().system('pip install seaborn --upgrade')


# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–µ–æ–±–∑–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

# In[2]:


import pandas as pd
import numpy as np
import seaborn as sns
sns.set(style = 'whitegrid', rc = {'figure.figsize':(14,10)})
import matplotlib.pyplot as plt

from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.ensemble import RandomForestClassifier
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, classification_report
from scipy.cluster.hierarchy import dendrogram, linkage
from sklearn.cluster import KMeans
from sklearn.model_selection import RandomizedSearchCV

import warnings
warnings.filterwarnings('ignore')
pd.options.display.float_format = '{:,.2f}'.format


# In[3]:


#–ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ seaborn
sns.__version__


# In[4]:


gym_data = pd.read_csv('/datasets/gym_churn.csv')
gym_data.head()


# –ù–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –≤–∫–ª—é—á–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è:
# - 'Churn' ‚Äî —Ñ–∞–∫—Ç –æ—Ç—Ç–æ–∫–∞ –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ;
# 
# –¢–µ–∫—É—â–∏–µ –ø–æ–ª—è –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ:
# 
# –î–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –¥–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–∞–∫—Ç–∞ –æ—Ç—Ç–æ–∫–∞ –º–µ—Å—è—Ü:
# - 'gender' ‚Äî –ø–æ–ª;
# - 'Near_Location' ‚Äî –ø—Ä–æ–∂–∏–≤–∞–Ω–∏–µ –∏–ª–∏ —Ä–∞–±–æ—Ç–∞ –≤ —Ä–∞–π–æ–Ω–µ, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ñ–∏—Ç–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä;
# - 'Partner' ‚Äî —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –∫–æ–º–ø–∞–Ω–∏–∏-–ø–∞—Ä—Ç–Ω—ë—Ä–∞ –∫–ª—É–±–∞ (—Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ —Å –∫–æ–º–ø–∞–Ω–∏—è–º–∏, —á—å–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –º–æ–≥—É—Ç –ø–æ–ª—É—á–∞—Ç—å —Å–∫–∏–¥–∫–∏ –Ω–∞ –∞–±–æ–Ω–µ–º–µ–Ω—Ç –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ —Ñ–∏—Ç–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª–µ –∫–ª–∏–µ–Ω—Ç–∞);
# - 'Promo_friends' ‚Äî —Ñ–∞–∫—Ç –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –∑–∞–ø–∏—Å–∏ –≤ —Ä–∞–º–∫–∞—Ö –∞–∫—Ü–∏–∏ ¬´–ø—Ä–∏–≤–µ–¥–∏ –¥—Ä—É–≥–∞¬ª (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø—Ä–æ–º–æ-–∫–æ–¥ –æ—Ç –∑–Ω–∞–∫–æ–º–æ–≥–æ –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞);
# - 'Phone' ‚Äî –Ω–∞–ª–∏—á–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞;
# - 'Age' ‚Äî –≤–æ–∑—Ä–∞—Å—Ç;
# - 'Lifetime' ‚Äî –≤—Ä–µ–º—è —Å –º–æ–º–µ–Ω—Ç–∞ –ø–µ—Ä–≤–æ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è –≤ —Ñ–∏—Ç–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä (–≤ –º–µ—Å—è—Ü–∞—Ö).
# 
# 
# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∂—É—Ä–Ω–∞–ª–∞ –ø–æ—Å–µ—â–µ–Ω–∏–π, –ø–æ–∫—É–ø–æ–∫ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º —Å—Ç–∞—Ç—É—Å–µ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞:
# - 'Contract_period' ‚Äî –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤—É—é—â–µ–≥–æ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ (–º–µ—Å—è—Ü, 3 –º–µ—Å—è—Ü–∞, 6 –º–µ—Å—è—Ü–µ–≤, –≥–æ–¥);
# - 'Month_to_end_contract' ‚Äî —Å—Ä–æ–∫ –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤—É—é—â–µ–≥–æ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ (–≤ –º–µ—Å—è—Ü–∞—Ö);
# - 'Group_visits' ‚Äî —Ñ–∞–∫—Ç –ø–æ—Å–µ—â–µ–Ω–∏—è –≥—Ä—É–ø–ø–æ–≤—ã—Ö –∑–∞–Ω—è—Ç–∏–π;
# - 'Avg_class_frequency_total' ‚Äî —Å—Ä–µ–¥–Ω—è—è —á–∞—Å—Ç–æ—Ç–∞ –ø–æ—Å–µ—â–µ–Ω–∏–π –≤ –Ω–µ–¥–µ–ª—é –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è —Å –Ω–∞—á–∞–ª–∞ –¥–µ–π—Å—Ç–≤–∏—è –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞;
# - 'Avg_class_frequency_current_month' ‚Äî —Å—Ä–µ–¥–Ω—è—è —á–∞—Å—Ç–æ—Ç–∞ –ø–æ—Å–µ—â–µ–Ω–∏–π –≤ –Ω–µ–¥–µ–ª—é –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü;
# - 'Avg_additional_charges_total' ‚Äî —Å—É–º–º–∞—Ä–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ –æ—Ç –¥—Ä—É–≥–∏—Ö —É—Å–ª—É–≥ —Ñ–∏—Ç–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä–∞: –∫–∞—Ñ–µ, —Å–ø–æ—Ä—Ç-—Ç–æ–≤–∞—Ä—ã, –∫–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–∏–π –∏ –º–∞—Å—Å–∞–∂–Ω—ã–π —Å–∞–ª–æ–Ω.

# –ò–∑–º–µ–Ω–∏–º –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤:

# In[5]:


#–ø—Ä–∏–≤–µ–¥–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É –ø—Ä–∏ –ø–æ–º–æ—â–∏ –º–µ—Ç–æ–¥–∞ str.lower
gym_data.columns = gym_data.columns.str.lower()


# In[6]:


#–ø—Ä–æ–≤–µ—Ä–∏–º –Ω–æ–≤—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤
gym_data.columns


# ### –í—ã–≤–æ–¥
# 
# –ò—Å–º–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –Ω—É–∂–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç—ã. –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º gym_data. –ù–∞–∑–≤–∞–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É.

# ### –®–∞–≥ 2. –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö (EDA) <a id='step2'></a>
# [–ö —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é](#contents)

# #### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è <a id='step2.1'></a>

# –ò–∑—É—á–∏–º –æ–±—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ:

# In[7]:


#–ø—Ä–∏–º–µ–Ω–∏–º –∫ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—É –º–µ—Ç–æ–¥ info
gym_data.info()


# –ü—Ä–æ–≤–µ—Ä–∏–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã:

# In[8]:


gym_data.duplicated().sum()


# –ù–∞ –ø–µ—Ä–≤—ã–π –≤–∑–≥–ª—è–¥ –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –∏–º–µ—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ.
# 
# –ü—Ä–µ–º–µ–Ω–∏–º—É —Ñ—É–Ω–∫—Ü–∏—é describe() –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

# <div style="border:solid orange 2px; padding: 20px"> <b>–ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å</b><br>
# –ü–æ—Å—á–∏—Ç–∞—Ç—å –≤–µ—Ä—Ö–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—è —Ñ—É–Ω–∫—Ü–∏–∏, –ø—Ä–∏–º–µ—Äüëá.</div>  

# In[9]:


gym_data.describe().T    .assign(out=lambda row: 2.5*row['75%'] - 1.5*row['25%'])


# <hr style="border: 2px solid orange;" />

# <div class="alert alert-info" style="border:solid blue 2px; padding: 20px"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –°–ø–∞—Å–∏–±–æ –∑–∞ —Å–æ–≤–µ—Ç. –ö–∞–∫-—Ç–æ –Ω–∞—Å –º–µ—Ç–æ–¥—É assign –Ω–µ —É—á–∏–ª–∏, –≤–æ–∑—å–º—É –Ω–∞ –≤–æ–æ—Ä—É–∂–µ–Ω–∏–µ. –ù–∞–º–Ω–æ–≥–æ –±–æ–ª–µ–µ –ª–∞–∫–æ–Ω–∏—á–Ω—ã–π –∏ —á–∏—Ç–∞–µ–º—ã–π –∫–æ–¥ –ø–æ–ª—É—á–∞–µ—Ç—Å—è. </div>

# <div style="border:solid green 2px; padding: 20px"> <b>–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 2</b><br>üëç –û–ø—ã—Ç, –ø—Ä–∞–∫—Ç–∏–∫–∞ –∏ —á—Ç–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ —Ä–∞—Å—à–∏—Ä—è—é—Ç –≥—Ä–∞–Ω–∏—Ü—ã</div> 

# –ò–∑–±–∞–≤–∏–º—Å—è –æ—Ç –≤—ã–±—Ä–æ—Å–æ–≤. –ó–∞ –≤—ã–±—Ä–æ—Å—ã –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è, –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—è—â–∏–µ —Ç—Ä–µ—Ç–∏–π –∫–≤–∞—Ä—Ç–∏–ª—å –Ω–∞ –ø–æ–ª—Ç–æ—Ä–∞ –º–µ–∂–∫–≤–∞—Ä—Ç–∏–ª—å–Ω—ã—Ö —Ä–∞–∑–º–∞—Ö–∞.

# In[10]:


gym_data = gym_data.query('avg_additional_charges_total < 425 & avg_class_frequency_total <                           5 & avg_class_frequency_current_month < 5 & month_to_end_contract < 11')
gym_data.info()


# <div class="alert alert-info" style="border:solid blue 2px; padding: 20px"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b>
# –ü—Ä–æ–±–æ–≤–∞–ª –º–æ–¥–µ–ª–∏ –∏ —Å —É–¥–∞–ª–µ–Ω–∏–µ–º –≤—ã–±—Ä–æ—Å–æ–≤ –∏ –±–µ–∑, —Å —É–¥–∞–ª–µ–Ω–∏–µ–º –º–µ—Ç—Ä–∏–∫–∏ —Å—Ç–∞–ª–∏ –Ω–µ–º–Ω–æ–≥–æ –≤—ã—à–µ. –ú–æ–∂–Ω–æ –µ—â–µ –∏–∑–º–µ–Ω–∏—Ç—å —É—Å–ª–æ–≤–∏—è query –Ω–∞ ('avg_additional_charges_total < 400 & avg_class_frequency_total < 4 & avg_class_frequency_current_month < 4 & month_to_end_contract < 11') –∏ –ø–æ–ª—É—á–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ Accuracy:0.94 Precision:0.89 Recall:0.92 F1:0.91, –Ω–æ —É—Ö—É–¥—à–∞–µ—Ç—Å—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –∏, –º–Ω–µ –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ –º—ã —Ç–µ—Ä—è–µ–º –µ—â–µ –±–æ–ª—å—à–µ –∫–ª–∏–µ–Ω—Ç–æ–≤, –∏ –º–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å–ª–∏—à–∫–æ–º —É—Å—Ä–µ–¥–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –≤—ã—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É–ø—É—Å—Ç–∏—Ç—å –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.
# </div>

# <div style="border:solid green 2px; padding: 20px"> <b>–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 2</b><br>üëç –î–∞, –∏–º–µ–Ω–Ω–æ —Ç–∞–∫ –∏ –µ—Å—Ç—å, —á–µ–º –±–æ–ª–µ–µ —Ö–æ—Ä–æ—à–∏–µ –¥–∞–Ω–Ω—ã–µ (–±–µ–∑ –≤—ã–±—Ä–æ—Å–æ–≤ –∏ –∞–Ω–æ–º–∞–ª–∏–π) —Ç—ã –ø–æ–¥—Å–æ–≤—ã–≤–∞–µ—à—å –º–æ–¥–µ–ª–∏, —Ç–µ–º –µ—ë –ª–µ–≥—á–µ –∏ –æ–Ω–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤ –Ω–µ–∫–æ—Ç–æ—Ä–æ–º —Å–º—ã—Å–ª–µ —É—Å—Ä–µ–¥–Ω—è–µ—Ç—Å—è. </div> 

# <div style="border:solid green 2px; padding: 20px"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</b><br>
# –ú–æ–ª–æ–¥–µ—Ü, —á—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏–ª. –≠—Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ–Ω–∫–∏–π –º–æ–º–µ–Ω—Ç, —Å–ª–µ–¥—É–µ—Ç —Ç–∞–∫ –¥–µ–ª–∞—Ç—å –∏–ª–∏ –Ω–µ—Ç. –£–¥–∞–ª—è—è –∏–∑ –¥–∞–Ω–Ω—ã—Ö –≤—ã–±—Ä–æ—Å—ã –º—ã —É–ø—Ä–æ—â–∞–µ–º —Ä–∞–±–æ—Ç—É –º–æ–¥–µ–ª–∏ - –µ–π –ø—Ä–æ—â–µ –æ–±—É—á–∏—Ç—å—Å—è –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–æ –≤ —Ç–æ–∂–µ –æ–Ω–∞ –±—É–¥–µ—Ç –ø–ª–æ—Ö–æ —Å–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å –ø—Ä–æ–≥–Ω–æ–∑–æ–º –∞–Ω–æ–º–∞–ª—å–Ω—ã—ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –£—à–µ–¥—à–∏–µ –∫–ª–∏–µ–Ω—Ç—ã —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –≤–µ–¥—É—Ç —Å–µ–±—è –æ—Ç–ª–∏—á–Ω–æ (–≤—ã–±—Ä–æ—Å—ã –∏–ª–∏ –±–ª–∏–∑–∫–∏ –∫ –≤—ã–±—Ä–æ—Å–∞–º) –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –º–∞—Å—Å—ã (–Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)</div>  

# #### –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –¥–≤—É—Ö –≥—Ä—É–ø–ø–∞—Ö ‚Äî —Ç–µ—Ö, –∫—Ç–æ —É—à–µ–ª –≤ –æ—Ç—Ç–æ–∫ –∏ —Ç–µ—Ö, –∫—Ç–æ –æ—Å—Ç–∞–ª—Å—è <a id='step2.2'></a>

# –°–≥—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º gym_data –ø–æ –æ—Ç—Ç–æ–∫—É –∫–ª–∏–µ–Ω—Ç–æ–≤.

# In[11]:


#–º–µ—Ç–æ–¥ groupby –ø–æ —Å—Ç–æ–ª–±—Ü—É 'churn' –∏ —Å—Ä–µ–¥–Ω–∏–º –∑–Ω–∞—á–µ–Ω–∏—è–º —Å—Ç–æ–ª–±—Ü–æ–≤
churn_grouped = gym_data.groupby('churn').mean()
churn_grouped


# –í —Å—Ä–µ–¥–Ω–µ–º –º–µ–Ω—å—à–µ —É—Ö–æ–¥—è—Ç –∫–ª–∏–µ–Ω—Ç—ã –±–ª–∏–∑–∫–æ –∂–∏–≤—É—â–∏–µ, –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–µ –¥—Ä—É–∑—å—è–º–∏, —Å –¥–ª–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞–º–∏, —á–∞—â–µ –ø–æ—Å–µ—â–∞—é—â–∏–µ –∑–∞–ª –∏ —Ç—Ä–∞—Ç—è—â–∏–µ –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥.

# <div style="border:solid green 2px; padding: 20px"> <b>–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞</b><br>
# –ö–ª–∞—Å—Å–Ω–æ, —á—Ç–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª —Å—Ä–µ–¥–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –ø–æ —Ü–µ–ª–µ–≤–æ–π - —É–∂–µ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ö–æ—Ä–æ—à–∏–µ –≤—ã–≤–æ–¥—ã</div>  

# #### –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å—Ç–æ–ª–±—á–∞—Ç—ã—Ö –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —É—à—ë–ª (–æ—Ç—Ç–æ–∫) –∏ —Ç–µ—Ö, –∫—Ç–æ –æ—Å—Ç–∞–ª—Å—è (–Ω–µ –ø–æ–ø–∞–ª–∏ –≤ –æ—Ç—Ç–æ–∫) <a id='step2.3'></a>

# –ü–æ—Å—Ç—Ä–æ–∏–º —Å—Ç–æ–ª–±—á–∞—Ç—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –¥–ª—è –±–∏–Ω–∞—Ä–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:

# In[12]:


plt.subplots(figsize=(13,10))
num_cols = 3
num_rows = 2

for i, col in enumerate(['gender', 'near_location', 'partner', 'promo_friends', 'phone', 'group_visits']):
    sns.countplot(x = gym_data[col], hue = 'churn', data = gym_data, ax = plt.subplot(num_rows, num_cols, i+1))
    plt.title('\n' + col)
    plt.xlabel('–Ω–∞–ª–∏—á–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∞' + '\n')
    plt.tight_layout()
    if i == 0: plt.legend()


# –ü–æ—Å—Ç—Ä–æ–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:

# In[13]:


for cols in ['contract_period', 'age', 'avg_additional_charges_total', 'month_to_end_contract', 
                         'lifetime', 'avg_class_frequency_total', 'avg_class_frequency_current_month']:
    sns.displot(x = gym_data[cols], col = 'churn', data = gym_data, hue = 'churn')
    plt.tight_layout()


# <div style="border:solid green 2px; padding: 20px"> <b>–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 2</b><br>üëç–ì–ª–∞–≤–Ω–æ–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –µ—Å—Ç—å, —Å–º—ã—Å–ª –µ—ë –ø–æ–Ω—è—Ç–µ–Ω, –∞ –Ω–∞ —Å–µ—Ç–∫–µ –æ–Ω–∞ –∏–ª–∏ –Ω–µ—Ç, –≤–æ–ø—Ä–æ—Å –≤—Ç–æ—Ä–æ–π</div> 

# <div class = "alert alert-block alert-info">
# –ü–æ—á–µ–º—É-—Ç–æ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å displot –Ω–∞ subplots. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–∂–Ω–∏–π –≥—Ä–∞—Ñ–∏–∫ –º–∞—Å—Å–∏–≤–∞. –ù–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π –æ—Å—Ç–∞–≤–∏–ª –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥. –ë—É–¥—É –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω, –µ—Å–ª–∏ —É–∫–∞–∂–µ—à—å –Ω–∞ –æ—à–∏–±–∫—É)</div>

# <div style="border:solid green 2px; padding: 20px"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</b><br>
# –°—Ç—Ä–∞–Ω–Ω–æ, –Ω–æ —è —Ç–æ–∂–µ –ø–æ—Ç–µ—Ä–ø–µ–ª –Ω–µ—É–¥–∞—á—É. –ù–µ —Ä–∞–±–æ—Ç–∞–ª —Å –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–µ–π seaborn, –º–æ–∂–µ—Ç —Ç–∞–º —á—Ç–æ-—Ç–æ —Ö–∏—Ç—Ä–æ–µ –∏–ª–∏ –∫—Ä–∏–≤–æ–µ. –ü–æ–ª–∞–≥–∞—é, —á—Ç–æ –∏–º–µ–Ω–Ω–æ —Å displot —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫. –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤ —Ü–∏–∫–ª–µ, –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞–∫–ª–∞–¥—ã–≤–∞—Ç—å –Ω–∞ —Å–µ—Ç–∫—É.</div>  

# In[14]:


plt.subplots(figsize=(13,15))
plt.suptitle('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ –æ—Ç—Ç–æ–∫—É')
num_cols = 3
num_rows = 3

for i, col in enumerate(['contract_period','age','avg_additional_charges_total', 'month_to_end_contract', 
                         'lifetime', 'avg_class_frequency_total', 'avg_class_frequency_current_month']):
    sns.boxplot(x = 'churn', data = gym_data, y = gym_data[col], ax = plt.subplot(num_rows, num_cols, i+1))
    plt.tight_layout()
    plt.subplots_adjust(top = 0.95)


# –ü–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç —Å–¥–µ–ª–∞–Ω–Ω—ã–µ —Ä–∞–Ω–µ–µ –≤—ã–≤–æ–¥—ã, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ —Å—Ä–µ–¥–Ω–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞.
# –†–µ–∂–µ —É—Ö–æ–¥—è—Ç –∫–ª–∏–µ–Ω—Ç—ã –±–ª–∏–∑–∫–æ –∂–∏–≤—É—â–∏–µ, –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–µ –¥—Ä—É–∑—å—è–º–∏, —Å –¥–ª–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞–º–∏, —á–∞—â–µ –ø–æ—Å–µ—â–∞—é—â–∏–µ –∑–∞–ª –∏ —Ç—Ä–∞—Ç—è—â–∏–µ –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥. –¢–∞–∫–∂–µ —Å—Ä–µ–¥–Ω–∏–π –≤–æ–∑—Ä–∞—Å—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ –≥—Ä—É–ø–ø—ã –æ—Ç—Ç–æ–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–∏–∂–µ. –í–∏–¥–∏–º–æ, –º–æ–ª–æ–¥—ã–µ –µ—â–µ –Ω–µ –Ω–∞—à–ª–∏ —Ç–æ, —á—Ç–æ –∏—â—É—Ç –∏ –ø—Ä–æ–±—É—é—Ç —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ. –í–æ–∑–º–æ–∂–Ω–æ, —á—Ç–æ —Å–∞–º –∑–∞–ª –ø–æ –∫–∞–∫–∏–º-—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –±–æ–ª—å—à–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –±–æ–ª–µ–µ –≤–∑—Ä–æ—Å–ª—ã–º.

# #### –ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ <a id='step2.4'></a>

# –ü–æ—Å—Ç—Ä–æ–∏–º –º–∞—Ç—Ä–∏—Ü—É –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –∏ —Ç–µ–ø–ª–æ–≤—É—é –∫–∞—Ä—Ç—É –º–∞—Ç—Ä–∏—Ü—ã –¥–ª—è –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ gym_data:

# In[15]:


g_corr = gym_data.corr()
g_corr


# In[16]:


sns.heatmap(g_corr, square = True, annot = True, fmt = '.1g', cmap = 'bwr');


# <div style="border:solid green 2px; padding: 20px"> <b>–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 2</b><br>üëç</div> 

# –í–∏–¥–∏–º —Å–∏–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏–µ –º–µ–∂–¥—É —Å–æ–±–æ–π –ø—Ä–∏–∑–Ω–∞–∫–∏ 'avg_class_frequency_total' –∏ 'avg_class_frequency_current_month'. –ü—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –º–æ–¥–µ–ª–∏ –º–æ–∂–Ω–æ –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç –æ–¥–Ω–æ–≥–æ –∏–∑ –Ω–∏—Ö. –ù–æ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Å–∞–º–∏ –≤—ã–±–∏—Ä–∞—é—Ç –∫–æ–ª-–≤–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –ø–æ—ç—Ç–æ–º—É –æ—Å—Ç–∞–≤–∏–º –ø—Ä–∏–∑–Ω–∞–∫ –Ω–∞ –º–µ—Å—Ç–µ.

# <div class = "alert alert-block alert-info"> 
# –Ø –ø—Ä–æ–±–æ–≤–∞–ª –¥—Ä–æ–ø–Ω—É—Ç—å –æ–¥–∏–Ω –∏–∑ —Å—Ç–æ–ª–±—Ü–æ–≤, –Ω–æ —Ç–æ–≥–¥–∞ —Ç–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ —Å–∏–ª—å–Ω–æ —Å—Ç—Ä–∞–¥–∞–µ—Ç. </div>

# <div style="border:solid orange 2px; padding: 20px"> <b>–ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å</b><br>
# <ul>
#     <li>–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –æ–¥–Ω–æ–≥–æ –∏–∑ —Å–∏–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –º–µ—Ç—Ä–∏–∫–∏ –º–æ–≥—É—Ç —Å–Ω–∏–∑–∏—Ç—å—Å—è –Ω–µ–º–Ω–æ–≥–æ, –Ω–æ –µ—Å–ª–∏ —Å–∏–ª—å–Ω–æ, –∑–Ω–∞—á–∏—Ç –≥–¥–µ-—Ç–æ —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫, —Ä–∞–∑–±–µ—Ä–µ–º—Å—è. –í–µ—Ä–æ—è—Ç–Ω–æ, –º–æ–¥–µ–ª–∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω—ã
# <li>–í–∏–∂—É —Ç—ã –ø—ã—Ç–∞–ª—Å—è –≤—ã–±—Ä–∞—Ç—å —Ü–≤–µ—Ç–æ–≤—É—é –ø–∞–ª–∏—Ç—Ä—É. –°–º–æ—Ç—Ä–∏, –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ª–µ–∂–∏—Ç –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç -1 –¥–æ 1, –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞ —Ö–æ—Ä–æ—à–æ –∞—Å—Å–æ—Ü–∏–∏—Ä—É—é—Ç—Å—è —Å —Ö–æ–ª–æ–¥–Ω—ã–º–∏ –∏ —Ç–µ–ø–ª—ã–º–∏ —Ü–≤–µ—Ç–∞–º–∏, –ø–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ –≤—ã–±—Ä–∞—Ç—å —Å–∏–Ω–µ–∫—Ä–∞—Å–Ω—É—é –ø–∞–ª–∏—Ç—Ä—É –¥–æ–ª–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—Å—è –æ—Ç–ª–∏—á–Ω–æ.</ul><br>
# <img src=http://storage.yandexcloud.net/public-bucket-6/cmaps.png></div>  

# ### –í—ã–≤–æ–¥ <a id='step2.5'></a>
# 
# –ë—ã–ª–∏ –∏–∑—É—á–µ–Ω—ã –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞, —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ. –£–¥–∞–ª–µ–Ω—ã –≤—ã–±—Ä–æ—Å—ã. –ó–∞ –≤—ã–±—Ä–æ—Å—ã –ø—Ä–∏–Ω—è—Ç—ã –∑–Ω–∞—á–µ–Ω–∏—è, –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—è—â–∏–µ —Ç—Ä–µ—Ç–∏–π –∫–≤–∞—Ä—Ç–∏–ª—å –ø—Ä–∏–∑–Ω–∞–∫–∞ –Ω–∞ –ø–æ–ª—Ç–æ—Ä–∞ –º–µ–∂–∫–≤–∞—Ä—Ç–∏–ª—å–Ω—ã—Ö —Ä–∞–∑–º–∞—Ö–∞. <br>
# –ü–æ—Å—Ç—Ä–æ–µ–Ω—ã —Å—Ç–æ–ª–±—á–∞—Ç—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –±–∏–Ω–∞—Ä–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö. –ü–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º –¥–∏–∞–≥—Ä–∞–º–º–∞–º –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥, —á—Ç–æ —Ä–µ–∂–µ —É—Ö–æ–¥—è—Ç –∫–ª–∏–µ–Ω—Ç—ã –±–ª–∏–∑–∫–æ –∂–∏–≤—É—â–∏–µ, –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–µ –¥—Ä—É–∑—å—è–º–∏, —Å –¥–ª–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞–º–∏, —á–∞—â–µ –ø–æ—Å–µ—â–∞—é—â–∏–µ –∑–∞–ª –∏ —Ç—Ä–∞—Ç—è—â–∏–µ –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥. –¢–∞–∫–∂–µ —Å—Ä–µ–¥–Ω–∏–π –≤–æ–∑—Ä–∞—Å—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ –≥—Ä—É–ø–ø—ã –æ—Ç—Ç–æ–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–∏–∂–µ.

# ### –®–∞–≥ 3. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç—Ç–æ–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ <a id='step3'></a>
# [–ö —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é](#contents)

# #### –†–∞–∑–±–∏–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—É—é –≤—ã–±–æ—Ä–∫–∏ <a id='step3.1'></a>

# –†–∞–∑–¥–µ–ª–∏–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ –≤—ã–±–æ—Ä–∫–∏ –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ñ—É–Ω–∫—Ü–∏–∏ train_test_split:

# In[17]:


# —Ä–∞–∑–¥–µ–ª–∏–º –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–º–∞—Ç—Ä–∏—Ü–∞ X) –∏ —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é (y)
X = gym_data.drop(columns = ['churn'])
y = gym_data['churn']

# —Ä–∞–∑–¥–µ–ª—è–µ–º –º–æ–¥–µ–ª—å –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—É—é –≤—ã–±–æ—Ä–∫—É, —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –æ–±—É—á–∞—é—â–µ–π/–≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–æ–∫: 80/20
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 0)


# #### –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ train-–≤—ã–±–æ—Ä–∫–µ –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–µ–π –∏ —Å–ª—É—á–∞–π–Ω—ã–º –ª–µ—Å–æ–º <a id='step3.2'></a>

# –°–æ–∑–¥–∞–¥–∏–º —Å–ø–∏—Å–æ–∫ —Å –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –∏ –∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

# In[18]:


models = [LogisticRegression(random_state = 0),
          RandomForestClassifier(random_state = 0, n_estimators = 20, max_depth = 10, max_features = 8,
                                n_jobs = -1)]


# <div class = "alert alert-block alert-info">
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–æ–±—Ä–∞–Ω—ã —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏) –≤—Ä—É—á–Ω—É—é </div>

# –ù–∞–ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –≤—ã–≤–æ–¥—è—â—É—é –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–¥–µ–ª–µ–π, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ä–∞–∑–Ω—ã–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏:

# In[19]:


def make_prediction(m, X_train, y_train, X_test, y_test):
    model = m
    #–æ–±—É—á–∏–º –º–æ–¥–µ–ª—å 
    model.fit(X_train, y_train)
    y_pred = model.predict(X_test)
    print('Accuracy:{:.2f} Precision:{:.2f} Recall:{:.2f} F1:{:.2f}'.format(accuracy_score(y_test, y_pred),
                                                                     precision_score(y_test, y_pred),
                                                                   recall_score(y_test, y_pred),
                                                                           f1_score(y_test, y_pred)))


# #### –û—Ü–µ–Ω–∫–∞ –º–µ—Ç—Ä–∏–∫ accuracy, precision –∏ recall –¥–ª—è –æ–±–µ–∏—Ö –º–æ–¥–µ–ª–µ–π –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π <a id='step3.3'></a>

# In[20]:


for i in models:
    print(i)
    print()
    make_prediction(i, X_train, y_train, X_test, y_test)
    report = classification_report(y_test, i.predict(X_test))
    print(report)
    print()


# –ü—Ä–æ–≤–µ—Ä–∏–º, –≤–æ–∑–º–æ–∂–Ω–æ, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–≤—ã—Å–∏—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏:

# In[21]:


#—Å–æ–∑–¥–¥–∏–º –æ–±—ä–µ–∫—Ç –∫–ª–∞—Å—Å–∞ scaler (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ç–æ—Ä)
scaler = StandardScaler() 
#–æ–±—É—á–∏–º scaler –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º –º–∞—Ç—Ä–∏—Ü—É –¥–ª—è –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏
X_train_st = scaler.fit_transform(X_train) 
X_test_st = scaler.transform(X_test)

for i in models:
    print(i)
    print()
    make_prediction(i, X_train_st, y_train, X_test_st, y_test)
    report = classification_report(y_test, i.predict(X_test_st))
    print(report)
    print()


# –°–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å –∏–º–µ–µ—Ç –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏, –¥–ª—è —Ä–∞–±–æ—Ç—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–µ. –ú–æ–¥–µ–ª—å –Ω–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ—Å–ª–µ –Ω–µ–µ –ø–æ–∫–∞–∑–∞–ª–∏ —Å—Ä–∞–≤–Ω–∏–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

# #### <div style="border:solid red 2px; padding: 20px"> <b>–ß—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å</b><br>
# –Ø –±—ã —Å–∫–∞–∑–∞–ª, —á—Ç–æ –º–æ–¥–µ–ª–∏ –≤–æ–æ–±—â–µ –Ω–µ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—Ç –æ—Ç—Ç–æ–∫, —Ç–∞–∫ –∫–∞–∫ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–∞—è –º–æ–¥–µ–ª—å, —Å–¥–µ–ª–∞–µ—Ç —ç—Ç–æ –ª—É—á—à–µ. –ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ—Å—Ç–∞, —Ç—ã –Ω–µ –≤–µ—Ä–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—à—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—é.<br>
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è - —ç—Ç–æ —Ç–æ–∂–µ –º–æ–¥–µ–ª—å, —Å–æ–∑–¥–∞–≤–∞—è –æ–±—ä–µ–∫—Ç (<code>scaler = StandardScaler()</code>), —Ç—ã –¥–æ–ª–∂–µ–Ω –æ–±—É—á–∏—Ç—å –µ–≥–æ –Ω–∞ train –≤—ã–±–æ—Ä–∫–µ, –∞ —Ç–µ—Å—Ç–æ–≤—É—é —Ç–æ–ª—å–∫–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–≤—ã–≤–∞—Ç—å - <code>transform</code><br>
# –î–ª—è –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —ç—Ç–æ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å, –∞ –≤–æ—Ç –º–µ—Ç—Ä–∏–∫–∏ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ª–µ—Å–∞ –Ω–µ –¥–æ–ª–∂–Ω—ã –∏–∑–º–µ–Ω–∏—Ç—å—Å—è, –µ—Å–ª–∏ —Ç–æ–ª—å–∫–æ —Å–æ—Ç—ã–µ –¥–æ–ª–∏)</div>

# <div class="alert alert-info" style="border:solid blue 2px; padding: 20px"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ù–µ–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–∞—è –∫–æ–ø–∏–ø–∞—Å—Ç–∞ –º–µ–Ω—è –ø–æ–¥–≤–µ–ª–∞, —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª, –≤—Å—Ç–∞–≤–∏–ª, –∞ –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–¥ –∑–∞–±—ã–ª)
# –í—Ä–æ–¥–µ –±—ã –∏—Å–ø—Ä–∞–≤–∏–ª, –Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ª—É—á—à–µ –Ω–µ —Å—Ç–∞–ª) </div>

# <div style="border:solid green 2px; padding: 20px"> <b>–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 2</b><br>üëç –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø–∞–Ω–∞—Ü–µ—è, –∑–Ω–∞—á–∏—Ç –∏ –±–µ–∑ –Ω–µ–µ, –ª–æ–≥–∏—á—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –æ—Ç–ª–∏—á–Ω–æ. –î—Ä—É–≥–æ–µ –¥–µ–ª–æ, –µ—Å–ª–∏ —Ç—ã –∑–∞—Ö–æ—á–µ—à—å —Å—Ä–∞–≤–Ω–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø—Ä–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö, —Ç–æ–≥–¥–∞ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—é - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø–æ–ª—É—á–∞—Ç—Å—è –≤ –æ–¥–Ω–æ–º –º–∞—Å—à—Ç–∞–±–µ –∏ –∏—Ö –º–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å. –ö—Å—Ç–∞—Ç–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ —Ç–∏–ø –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤–ª–∏—è–µ—Ç –Ω–∞ –º–µ—Ç—Ä–∏–∫–∏ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –æ–¥–Ω–æ –∏–∑, –µ—Å—Ç—å MinMaxSCaler <a href="https://scikit-learn.org/stable/modules/preprocessing.html">–∏ –¥—Ä—É–≥–∏–µ</a>)</div> 

# <div style="border:solid red 2px; padding: 20px"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</b><br>
# GridSearch - –∏—â–µ—Ç –Ω–∞–∏–ª—É—á—à–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏, –∑–∞ —Å—á–µ—Ç –∫—Ä–æ—Å—Å–≤–∞–ª–∏–¥–∞—Ü–∏–∏, —Ç–æ –µ—Å—Ç—å –º–æ–¥–µ–ª—å –≤–∏–¥–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ. –£ –ø–æ–∏—Å–∫–∞ –µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä <code>refit</code> - –ø–æ-—É–º–æ–ª—á–∞–Ω–∏—é –æ–Ω = True, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç - –º–æ–¥–µ–ª—å —Å –ª—É—á—à–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –±—É–¥–µ—Ç –æ–±—É—á–µ–Ω–∞ –Ω–∞ –≤—Å–µ–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ. –ü–æ—Å–ª–µ –ø–æ–∏—Å–∫–∞ —Ç—ã –µ—â–µ —Ä–∞–∑ –æ–±—É—á–∞–µ—à—å –µ—ë –Ω–∞ train. –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –º–æ–¥–µ–ª–∏. + —Å —Ç–∞–∫–∏–º –∫–æ–ª-–≤–æ–º –¥–µ—Ä–µ–≤—å–µ–≤ –º–æ–¥–µ–ª—å –≤–µ—Ä–æ—è—Ç–Ω–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∞<br>
# –ï—Å–ª–∏ –µ—Å—Ç—å –∂–µ–ª–∞–Ω–∏–µ, —Ç–æ –≤–µ—Å—å –¥–∞—Ç–∞—Å–µ—Ç –º–æ–∂–Ω–æ —Ä–∞–∑–±–∏—Ç—å –Ω–∞ 3 —á–∞—Å—Ç–∏ - train\test\valid. train –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–ø–æ–∏—Å–∫ –ø–æ —Å–µ—Ç–∫–µ –∏–ª–∏ –ø–µ—Ä–µ–±–æ—Ä —Ü–∏–∫–ª–∞–º–∏, –∫–∞–∫ —É–¥–æ–±–Ω–æ, —è –±—ã –æ–≥—Ä–∞–Ω–∏—á–∏–ª –∫–æ–ª-–≤–æ –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –±—ã –Ω–∞ –∫–æ–ª-–≤–µ –¥–µ—Ä–µ–≤—å–µ–≤, –∫–æ–ª-–≤–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ –≥–ª—É–±–∏–Ω–µ, –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ –æ—á–µ–Ω—å —Ç–æ–Ω–∫–æ.). test –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –≤–æ –≤—Ä–µ–º—è –ø–æ–¥–±–æ—Ä–∞. valid –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏.<br>
# –¢—É—Ç –¥–µ–ª–æ –Ω–µ –≤ –ø–æ–ø—ã—Ç–∫–µ, –∞ –≤ –∂–µ–ª–∞–Ω–∏–∏ —Å–¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –ª—É—á—à–µ —á–µ–º —É–∂–µ –µ—Å—Ç—å. –ü–æ–¥–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏ - —ç—Ç–æ –¥–∞–ª–µ–∫–æ –Ω–µ –ø–µ—Ä–≤–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞. –Ø —Å—á–∏—Ç–∞—é, —á—Ç–æ –∑–∞–¥–∞—á—É –Ω—É–∂–Ω–æ —Ä–µ—à–∞—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—ã–º –∏ –ø–æ–Ω—è—Ç–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º –∏–∑ –≤–æ–∑–º–æ–∂–Ω—ã—Ö. –í –Ω–∞—á–∞–ª–µ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ –¥–∞–Ω–Ω—ã—Ö, EDA –∏ –æ—Ç–±–æ—Ä–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.<br>
# –ß—Ç–æ –µ—â–µ –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–≥–Ω–æ–∑–∞:<br>
# <ul>
#     <li> –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–∏–∑–Ω–∞–∫ –∏–∑ –ø–∞—Ä—ã —Å–∏–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏—Ö, –ø–æ–¥–æ–π–¥—É—Ç –ª–∏–Ω–µ–π–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ (—Å–ª–æ–∂–µ–Ω–∏–µ\–≤—ã—á–∏—Ç–∞–Ω–∏–µ\—É–º–Ω–æ–∂–µ–Ω–∏–µ\–¥–µ–ª–µ–Ω–∏–µ)
#     <li> —É—Å—Ç—Ä–∞–Ω–∏—Ç—å\—Å–Ω–∏–∑–∏—Ç—å –¥–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤<br>
#     <ul>
#         <li> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä <code>stratify</code> –¥–ª—è train_test_split  - –≤ train/test –≤—ã–±–æ—Ä–∫–∏ –±—É–¥—É—Ç –ø–æ–ø–∞–¥–∞—Ç—å —Å —Ç–∞–∫–∏–º –∂–µ –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º
#         <li> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä <code>class_weight</code> –≤ –º–æ–¥–µ–ª—è—Ö
#         <li>—É–≤–µ–ª–∏—á–∏—Ç—å –º–µ–Ω—å—à–∏–π –∫–ª–∞—Å—Å (—Å–∞–º–æ–µ –ø—Ä–æ—Å—Ç–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –º–µ–Ω—å—à–µ–≥–æ –∫–ª–∞—Å—Å–∞, –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–µ—Å—Ç–∏ –¥–æ–ø —à—É–º –≤ –¥–∞–Ω–Ω—ã–µ)
#         <li>—É–º–µ–Ω—å—à–∏—Ç—å –±–æ–ª—å—à–∏–π –∫–ª–∞—Å—Å (–≤–∑—è—Ç—å –≤—ã–±–æ—Ä–∫—É –∏–∑ –±–û–ª—å—à–µ–≥–æ –∫–ª–∞—Å—Å–∞ —Ä–∞–∑–º–µ—Ä–æ–º —Å –º–µ–Ω—å—à–∏–π)</ul></ul><br><br>
# –ò–∑ –º–æ–¥–µ–ª–µ–π —Ç–∞–∫–∂–µ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, —Ç–æ –µ—Å—Ç—å –Ω–∞ –∫–∞–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –º–æ–¥–µ–ª—å –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –±–æ–ª—å—à–µ. –î–ª—è –ª–∏–Ω–µ–π–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π  - —ç—Ç–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø—Ä–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö (–¥–æ—Å—Ç—É–ø–Ω—ã –≤ –∞—Ç—Ä–∏–±—É—Ç–µ <code>model.coef_</code>), –¥–ª—è –¥–µ—Ä–µ–≤—å–µ–≤ —Ä–µ—à–µ–Ω–∏–π - <code>model.feature_importances_</code> - –∑–∞–≥–ª—è–Ω–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∫ –º–µ—Ç–æ–¥–∞–º<br>
# <a href="https://www.kaggle.com/harmeggels/random-forest-feature-importances">–ü—Ä–∏–º–µ—Ä 1</a><br>
# <a href="https://habr.com/ru/company/ods/blog/324402/#3-ocenka-vazhnosti-priznakov">–ü—Ä–∏–º–µ—Ä 2</a><br>
# <a href="https://dyakonov.org/2016/11/14/—Å–ª—É—á–∞–π–Ω—ã–π-–ª–µ—Å-random-forest/">–ü—Ä–∏–º–µ—Ä 3</a></div>

# –û–¥–∏–Ω –∏–∑ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø—Ä–∏–≤–µ–¥—É –Ω–∏–∂–µ. –í–∏–¥–Ω–æ, —á—Ç–æ 5 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–æ–∫—Ä—ã—Ç—å –º–æ–¥–µ–ª–∏ 90% –¥–∞–Ω–Ω—ã—Ö. –° —É—á–µ—Ç–æ–º —á—Ç–æ 2 –ø—Ä–∏–∑–Ω–∞–∫–∞ —Å–∏–ª—å–Ω–æ –ø–æ—Ö–æ–∂–∏. –í –æ–±—â–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥—É—é, —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Å—Ç–∏ —Ö–æ—Ä–æ—à–∏–π EDA\–æ—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ –¥–∞–ª–µ–µ –∑–∞–Ω–∏–º–∞—Ç—å—Å—è –º–æ–¥–µ–ª—è–º–∏.

# <hr style="border: 2px solid red;" />

# <div class="alert alert-info" style="border:solid blue 2px; padding: 20px"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> 
# –ü–æ–¥–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏ —è —Ä–µ—à–∏–ª —É–¥–∞–ª–∏—Ç—å, –¥—É–º–∞—é, –º–Ω–µ –Ω—É–∂–Ω–æ –ª—É—á—à–µ –∏–∑—É—á–∏—Ç—å —ç—Ç—É —Ç–µ–º—É, —ç—Ç–∏–º –∏ –∑–∞–π–º—É—Å—å –ø–æ—Å–ª–µ –ø—Ä–æ–µ–∫—Ç–∞. –ù–æ —Å–µ–π—á–∞—Å –ø–æ–∫–∞ —Å —ç—Ç–∏–º –º–∞–ª–æ —á—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è. <br>
# –í–∞—Ä–∏–∞–Ω—Ç —Å –Ω–æ–≤—ã–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∏–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏—Ö –Ω–µ –æ—Å–æ–±–æ –ø–æ–ª—É—á–∏–ª—Å—è. –î—Ä–æ–ø–Ω—É—Ç—å –ª–∏—à–Ω–∏–µ —Å—Ç–æ–ª–±—Ü—ã —Å –Ω–∏–∑–∫–∏–º –≤–µ—Å–æ–º –¥–∞–ª–æ –Ω–µ–±–æ–ª—å—à–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –õ—É—á—à–µ –≤—Å–µ–≥–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å –¥—Ä–æ–ø–Ω—É—Ç—å 'phone' –∏ 'group_visits'. –ú–µ—Ç—Ä–∏–∫–∏ —Å–æ–≤—Å–µ–º –Ω–µ–º–Ω–æ–≥–æ, –Ω–æ –≤—ã—Ä–æ—Å–ª–∏ (–¥–æ 1%). –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ—Å–ª–µ linkage –≤—ã–¥–∞–µ—Ç 3 –∫–ª–∞—Å—Ç–µ—Ä–∞ (—Ç—Ä–µ—Ç–∏–π —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π). –í –ø—Ä–∏–Ω–∏—Ü–ø–µ, –µ—Å–ª–∏ —Ä–∞–∑–±–∏–≤–∞—Ç—å –Ω–∞ 3, —Ç–æ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –æ—á–µ–Ω—å –Ω–µ–ø–ª–æ—Ö–æ - 2 —Å –Ω–∏–∑–∫–∏–º –æ—Ç—Ç–æ–∫–æ–º –∏ –±–æ–ª—å—à–æ–π —Ç—Ä–µ—Ç–∏–π –æ—Ç—Ç–æ—á–Ω—ã–π. –ù–æ –ø–æ —É—Å–ª–æ–≤–∏—é –∑–∞–¥–∞—á–∏ –º—ã –Ω–∞ 5 –¥–æ–ª–∂–Ω—ã —Ä–∞–∑–±–∏–≤–∞—Ç—å. –ï—Å–ª–∏ —Ä–∞–∑–±–∏–≤–∞—Ç—å –ø—Ä–∏ –Ω–æ–≤–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ 5, —Ç–æ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —É–∂–µ 3 —Å—Ä–µ–¥–Ω–µ–æ—Ç—Ç–æ—á–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞, –Ω–∏ —Ç—É–¥–∞, –Ω–∏ —Å—é–¥–∞. –ü–æ—ç—Ç–æ–º—É —è –æ—Å—Ç–∞–≤–∏–ª –∏–∑–Ω–∞—á–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç, –¥–∞ –∏ —Å—Ç–∞—Ä—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã —É–∂–µ –±—ã–ª–∏ –æ–ø–∏—Å–∞–Ω—ã))) <br>
# 
# –ù–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π —è –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–ª –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –∏ –Ω–æ–≤–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏. </div>

# <div style="border:solid green 2px; padding: 20px"> <b>–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 2</b><br>üëç–û–∫, —Ö–æ—Ä–æ—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ. –ú–æ–∂–µ—à—å –Ω–∞—á–∞—Ç—å —Å –ø–µ—Ä–µ–±–æ—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ —Ü–∏–∫–ª–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π –ø–æ–¥–≤—ã–±–æ—Ä–∫–µ (test\valid), –∞ –ø–æ–∏—Å–∫ –ø–æ —Å–µ—Ç–∫–µ –¥–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ –±–æ–ª—å—à–µ –≤—Å—è–∫–∏—Ö —Ñ–∏—á –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π</div> 

# In[22]:


'''pd.DataFrame(data = models[1].feature_importances_)    .assign(feature=X_train.columns)    .rename(columns={0: 'importance'})    .sort_values(by='importance', ascending=False)    .assign(cum_importance=lambda row: row['importance'].cumsum())    .style    .bar()

pd.DataFrame(data = models[0].coef_).T\
    .assign(feature = X_train.columns)\
    .rename(columns = {0: 'coef'})\
    .sort_values(by = 'coef', ascending = True)\
    .style\
    .bar()

gym_data.drop(['phone', 'group_visits'],
              axis = 1, inplace = True)

# —Ä–∞–∑–¥–µ–ª–∏–º –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–º–∞—Ç—Ä–∏—Ü–∞ X) –∏ —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é (y)
X = gym_data.drop(columns = ['churn'])
y = gym_data['churn']

# —Ä–∞–∑–¥–µ–ª—è–µ–º –º–æ–¥–µ–ª—å –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—É—é –≤—ã–±–æ—Ä–∫—É, —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –æ–±—É—á–∞—é—â–µ–π/–≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–æ–∫: 80/20
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 0)

models = [LogisticRegression(random_state = 0),
          RandomForestClassifier(random_state = 0, n_estimators = 20, max_depth = 10, max_features = 8,
                                n_jobs = -1)]

for i in models:
    print(i)
    print()
    make_prediction(i, X_train, y_train, X_test, y_test)
    report = classification_report(y_test, i.predict(X_test))
    print(report)
    print()'''


# ### –í—ã–≤–æ–¥ <a id='step3.4'></a>

# –ë—ã–ª–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã –º–æ–¥–µ–ª–∏ –ø–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º –°–ª—É—á–∞–π–Ω–æ–≥–æ –ª–µ—Å–∞ –∏ –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏. –°—Ä–∞–≤–Ω–µ–Ω—ã –º–æ–¥–µ–ª–∏, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –Ω–∞ –∏—Å—Ö–æ–¥–Ω—ã—Ö –æ—á–∏—â–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞–ª–∏ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –í –∫–∞—á–µ—Å—Ç–≤–µ –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ –≤—ã–±—Ä–∞–Ω –∞–ª–≥–æ—Ä–∏—Ç–º –°–ª—É—á–∞–π–Ω–æ–≥–æ –ª–µ—Å–∞ (Random Forest), –ø–æ–∫–∞–∑–∞–≤—à–∏–π –≤—ã—Å–æ–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–µ—Ç—Ä–∏–∫ (Accuracy: 0.92, Precision: 0.87, Recall: 0.87, F1: 0.87). <br>
# –ü—Ä–æ–≤–µ–¥–µ–Ω–∞ –ø–æ–ø—ã—Ç–∫–∞ –ø–æ–≤—ã—Å–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø–æ–¥–±–æ—Ä–æ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–Ω–∏–∑–∏–ª–∏ —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è. –ü—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω—è—Ç—å –∏—Å—Ö–æ–¥–Ω—É—é –º–æ–¥–µ–ª—å.

# ### –®–∞–≥ 4. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ <a id='step4'> </a>
# [–ö —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é](#contents)

# #### –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö <a id='step4.1'></a>

# –ü—Ä–æ–≤–µ–¥–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ñ—É–Ω–∫—Ü–∏–∏ StandartScaler():

# In[23]:


#—Å–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç –∫–ª–∞—Å—Å–∞ scaler (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ç–æ—Ä)
scaler = StandardScaler()
x_sc = scaler.fit_transform(gym_data.drop(columns = ['churn']))
x_sc


# #### –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π —Ñ—É–Ω–∫—Ü–∏–µ–π linkage() –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º—ã <a id='step4.2'></a>

# In[24]:


linked = linkage(x_sc, method = 'ward')
plt.figure()  
dendrogram(linked, orientation = 'top')
plt.xticks([])
plt.show() 


# –ê–ª–≥–æ—Ä–∏—Ç–º –≤—ã–¥–∞–ª –Ω–∞–º 4 –∫–ª–∞—Å—Ç–µ—Ä–∞, –Ω–æ, —Ç–∞–∫ –∫–∞–∫ —á–µ—Ç–≤–µ—Ä—Ç—ã–π –∫–ª–∞—Å—Ç–µ—Ä –¥–æ–≤–æ–ª—å–Ω–æ –æ–±—ä–µ–º–Ω—ã–π, –∑–∞–¥–∞–¥–∏–º –¥–ª—è –Ω–∞—à–∏—Ö —Ä–∞—Å—á–µ—Ç–æ–≤ —á–∏—Å–ª–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ —Ä–∞–≤–Ω–æ–µ 5.

# #### –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ K-Means –∏ –ø—Ä–æ–≥–Ω–æ–∑ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤ <a id='step4.3'></a>

# In[25]:


km = KMeans(n_clusters = 5, random_state = 0, n_init = 1) # –∑–∞–¥–∞—ë–º —á–∏—Å–ª–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤, —Ä–∞–≤–Ω–æ–µ 5
labels = km.fit_predict(x_sc) # –ø—Ä–∏–º–µ–Ω—è–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º –∫ –¥–∞–Ω–Ω—ã–º –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ–º –≤–µ–∫—Ç–æ—Ä –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ 
gym_data['cluster'] = labels
gym_data['cluster'].value_counts()


# –ü–æ–ª—É—á–∏–ª–∏ 5 –∫–ª–∞—Å—Ç–µ—Ä–æ–≤, —á–µ—Ç–≤–µ—Ä—Ç—ã–π –∫–ª–∞—Å—Ç–µ—Ä - —Å–∞–º—ã–π –æ–±—ä–µ–º–Ω—ã–π, –Ω—É–ª–µ–≤–æ–π - —Å–∞–º—ã–π –º–∞–ª–µ–Ω—å–∫–∏–π. –î–∞–ª–µ–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∞–º.

# #### –ò–∑—É—á–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤. –•–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ <a id='step4.4'></a>

# In[26]:


#–ø–æ–ª—É—á–∏–º —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –º–µ—Ç–æ–¥–æ–º groupby –ø–æ —Å—Ä–µ–¥–Ω–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
clusters_group = gym_data.groupby('cluster').mean().T
clusters_group


# –ú–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π –ø–µ—Ä–≤—ã–π –∫–ª–∞—Å—Ç–µ—Ä –∏–º–µ–µ—Ç —Å–∞–º—ã–π –≤—ã—Å–æ–∫–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –æ—Ç—Ç–æ–∫–∞. –ê–ª–≥–æ—Ä–∏—Ç–º —Å—Ä–∞–±–æ—Ç–∞–ª —Ö–æ—Ä–æ—à–æ, —Ç–∞–∫ –∫–∞–∫ –±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å —É—Ö–æ–¥—è—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ–ø–∞–ª–∞ –≤ –¥–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞. –ü–µ—Ä–≤—ã–π, –≤—Ç–æ—Ä–æ–π –∏ —á–µ—Ç–≤–µ—Ä—Ç—ã–π –∫–ª–∞—Å—Ç–µ—Ä—ã –∏–º–µ—é—Ç –Ω–∏–∑–∫–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –æ—Ç—Ç–æ–∫–∞, –∏—Ö –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–π –≤–æ–∑—Ä–∞—Å—Ç –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –æ—Ç—Å–∞–ª—å–Ω—ã–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏, –¥–æ–ª–≥–∏–º —É—Ä–æ–≤–Ω–µ–º —á–ª–µ–Ω—Å—Ç–≤–∞ –≤ –∫–ª—É–±–µ –∏ –±–æ–ª—å—à–æ–π —á–∞—Å—Ç–æ—Ç–æ–π –ø–æ—Å–µ—â–µ–Ω–∏—è. –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –≤ –æ—Ç—Ç–æ—á–Ω—ã—Ö –Ω—É–ª–µ–≤–æ–º –∏ —Ç—Ä–µ—Ç—å–µ–º –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö —Å–∞–º—ã–π –Ω–∏–∑–∫–∏–π —Å—Ä–µ–¥–Ω–∏–π –≤–æ–∑—Ä–∞—Å—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤.

# #### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ <a id='step4.5'></a>

# In[27]:


plt.subplots(figsize=(13,15))
plt.suptitle('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–∏–Ω–∞—Ä–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∞–º')
num_cols = 3
num_rows = 3

for i, col in enumerate(['gender', 'near_location', 'partner', 'promo_friends', 'phone', 'group_visits']):
    sns.countplot(data = gym_data, x = col, hue = 'cluster', ax = plt.subplot(num_rows, num_cols, i+1))
    plt.tight_layout()
    plt.subplots_adjust(top = 0.95)


# In[28]:


plt.subplots(figsize=(13,15))
plt.suptitle('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∞–º')
num_cols = 3
num_rows = 3

for i, col in enumerate(['contract_period','age','avg_additional_charges_total', 'month_to_end_contract', 
                         'lifetime', 'avg_class_frequency_total', 'avg_class_frequency_current_month']):
    sns.boxplot(data = gym_data, x = 'cluster', y = gym_data[col], ax = plt.subplot(num_rows, num_cols, i+1))
    plt.tight_layout()
    plt.subplots_adjust(top = 0.95)


# –ú–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
# - 'gender' (–ø–æ–ª): –Ω–∞–∏–º–µ–Ω–µ–µ –æ—Ç—Ç–æ—á–Ω—ã–µ 1, 2 –∏ 4 –∫–ª–∞—Å—Ç–µ—Ä—ã –∏–º–µ—é—Ç –Ω–µ–±–æ–ª—å—à–æ–µ –ø—Ä–µ–æ–±–ª–∞–¥–∞–Ω–∏–µ –ø–æ–ª–∞ 1 (–Ω–∞—Å–∫–æ–ª—å–∫–æ —è –ø–æ–Ω–∏–º–∞—é - —ç—Ç–æ –º—É–∂—Å–∫–æ–π), –≤ —Ç–æ –≤—Ä–µ–º—è, –∫–∞–∫ –±–æ–ª–µ–µ –æ—Ç—Ç–æ—á–Ω—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã –∏–º–µ—é—Ç –Ω–µ–±–æ–ª—å—à–æ–π –ø–µ—Ä–µ–≤–µ—Å –≤ —Å—Ç–æ—Ä–æ–Ω—É –∂–µ–Ω—â–∏–Ω. –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥, —á—Ç–æ –∂–µ–Ω—â–∏–Ω—ã –º–µ–Ω–µ–µ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã.
# - 'near_location' (–±–ª–∏–∑–∫–æ–µ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏–µ): –∞–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ä–µ–¥–µ–ª–∏–ª –≤—Å–µ—Ö –¥–∞–ª–µ–∫–æ –∂–∏–≤—É—â–∏—Ö –∏ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ –æ—Ç—Ç–æ—á–Ω—ã–π —Ç—Ä–µ—Ç–∏–π –∫–ª–∞—Å—Ç–µ—Ä. –û—Å—Ç–∞–ª—å–Ω—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ö–æ–∂–∏–π –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—ã—Å–æ–∫–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –ø–æ —ç—Ç–æ–º—É –ø—Ä–∏–∑–Ω–∞–∫—É.
# - 'partner' (—Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –∫–æ–º–ø–∞–Ω–∏–∏-–ø–∞—Ä—Ç–Ω–µ—Ä–∞ –∫–ª—É–±–∞): –ø—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ - –ø—Ä–∏–º–µ—Ä–Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤–æ –Ω–∏–∑–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å–∞–º–æ–º –æ—Ç—Ç–æ—á–Ω–æ–º –∫–ª–∞—Å—Ç–µ—Ä–µ, —Ç–∞–∫ –∏ –≤ –Ω–∏–∑–∫–æ –æ—Ç—Ç–æ—á–Ω–æ–º –≤—Ç–æ—Ä–æ–º. –í —Ü–µ–ª–æ–º, –Ω–µ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.
# - 'promo_friends' (–ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–µ –¥—Ä—É–≥–æ–º): –í —Ü–µ–ª–æ–º –≤ –æ—Ç—Ç–æ—á–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö –º–µ–Ω—å—à–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã—Ö –¥—Ä—É–≥–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
# - 'phone' (–Ω–∞–ª–∏—á–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞): –ø–æ —ç—Ç–æ–º—É –∫–ª–∞—Å—Ç–µ—Ä—É –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏–ª –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Ä–æ–≤–Ω—É.
# - 'group_visits' (–ø–æ—Å–µ—â–µ–Ω–∏–µ –≥—Ä—É–ø–ø–æ–≤—ã—Ö –∑–∞–Ω—è—Ç–∏–π): –≤ –æ—Ç—Ç–æ—á–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö —Å–∞–º—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –ø–æ—Å–µ—â–∞—é—â–∏—Ö –≥—Ä—É–ø–ø–æ–≤—ã–µ –∑–∞–Ω—è—Ç–∏–µ –Ω–∏–∂–µ (–≤ —Ä–∞–π–æ–Ω–µ 20-30%), –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π (45-50%).
# - 'contract_period' (–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞): —Å–∞–º—ã–π –Ω–∏–∑–∫–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –≤ –Ω—É–ª–µ–≤–æ–º, —Ç—Ä–µ—Ç—å–µ–º (–æ—Ç—Ç–æ—á–Ω—ã—Ö) –∏ –≤—Ç–æ—Ä–æ–º –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö. –°–∞–º–∞—è –¥–ª–∏–Ω–Ω–∞—è —Å—Ä–µ–¥–Ω—è—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ (–±–æ–ª–µ–µ 7 –º–µ—Å—è—Ü–µ–≤) -  –≤ –Ω–∏–∑–∫–æ –æ—Ç—Ç–æ—á–Ω—ã—Ö –ø–µ—Ä–≤–æ–º –∏ —á–µ—Ç–≤–µ—Ä—Ç–æ–º –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö.
# - 'age' (–≤–æ–∑—Ä–∞—Å—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤): —Å–∞–º—ã–π "—Å—Ç–∞—Ä—ã–µ" –∫–ª–∞—Å—Ç–µ—Ä—ã - –ø–µ—Ä–≤—ã–π, –≤—Ç–æ—Ä–æ–π –∏ —á–µ—Ç–≤–µ—Ä—Ç—ã–π (–∫–ª–∞—Å—Ç–µ—Ä—ã —Å –Ω–∏–∑–∫–∏–º –æ—Ç—Ç–æ–∫–æ–º). –ù–∞–∏–±–æ–ª–µ–µ –æ—Ç—Ç–æ—á–Ω—ã–µ –Ω—É–ª–µ–≤–æ–π –∏ —Ç—Ä–µ—Ç–∏–π - —Å–∞–º—ã–µ "–º–æ–ª–æ–¥—ã–µ". –ß–µ–º —Å—Ç–∞—Ä—à–µ –∫–ª–∏–µ–Ω—Ç—ã, —Ç–µ–º –Ω–∏–∂–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∏—Ö —É—Ö–æ–¥–∞. 
# - 'avg_additional_charges_total' (—Å—É–º–º–∞—Ä–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ –æ—Ç –¥–æ–ø. —É—Å–ª—É–≥ —Ñ–∏—Ç–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä–∞): —á–µ–º –Ω–∏–∂–µ –æ—Ç—Ç–æ–∫ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ, —Ç–µ–º –±–æ–ª—å—à–µ —Ç—Ä–∞—Ç—è—Ç –¥–µ–Ω–µ–≥ –∫–ª–∏–µ–Ω—Ç—ã. –í–∏–¥–∏–º–æ, –¥–æ–≤–æ–ª—å–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –¥–æ–≤–æ–ª—å–Ω—ã –≤–æ –≤—Å–µ–º.
# - 'month_to_end_contract' (—Å—Ä–æ–∫ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤—É—é—â–µ–≥–æ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ –≤ –º–µ—Å—è—Ü–∞—Ö): –±–æ–ª–µ–µ –ø–æ–ª—É–≥–æ–¥–∞ –≤ —Å—Ä–µ–¥–Ω–µ–º –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –≤ –Ω–∞–∏–º–µ–Ω–µ–µ –æ—Ç—Ç–æ—á–Ω—ã—Ö 1 –∏ 4 –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö, —á—É—Ç—å –±–æ–ª–µ–µ –º–µ—Å—è—Ü–∞ - –≤ –æ—Ç—Ç–æ—á–Ω—ã—Ö 0 –∏ 3. –í—Ä–æ–¥–µ –±—ã –µ—Å—Ç—å –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å, –Ω–æ –≤–æ –≤—Ç–æ—Ä–æ–º –ª–æ—è–ª—å–Ω–æ–º –∫–ª–∞—Å—Ç–µ—Ä–µ –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –µ—â–µ –º–µ–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏, —á–µ–º –≤ —Ç—Ä–µ—Ç—å–µ–º. –í–∏–¥–∏–º–æ, –∫–ª–∏–µ–Ω—Ç—ã –∏–∑ —ç—Ç–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ –ª—é–±—è—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π —Ü–µ–Ω—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –¥–µ–Ω–µ–≥.
# - 'lifetime' (–≤—Ä–µ–º—è —Å –º–æ–º–µ–Ω—Ç–∞ –ø–µ—Ä–≤–æ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è –≤ —Ñ–∏—Ç–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä): —Ç—É—Ç –ø—Ä—è–º–∞—è —Å–≤—è–∑—å –º–µ–∂–¥—É –æ—Ç—Ç–æ–∫–æ–º –∏ –≤—Ä–µ–º–µ–Ω–µ–º. –ß–µ–º –¥–æ–ª—å—à–µ –∫–ª–∏–µ–Ω—Ç—ã —Ö–æ–¥—è—Ç –≤ –∫–ª—É–±, —Ç–µ–º –º–µ–Ω—å—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∏—Ö —É—Ö–æ–¥–∞.
# - 'avg_class_frequency_total' (—Å—Ä–µ–¥–Ω—è —á–∞—Å—Ç–æ—Ç–∞ –ø–æ—Å–µ—â–µ–Ω–∏–π –≤ –Ω–µ–¥–µ–ª—é –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è): –≤ –º–∞–ª–æ–æ—Ç—Ç–æ—á–Ω—ã–µ –ø–µ—Ä–≤—ã–π –∏ –≤—Ç–æ—Ä–æ–π –∫–ª–∞—Å—Ç–µ—Ä—ã –ø–æ–ø–∞–ª–∏ –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—â–µ –ø–æ—Å–µ—â–∞—é—â–∏–µ –∫–ª—É–± –∫–ª–∏–µ–Ω—Ç—ã, –ø—Ä–∏ —ç—Ç–æ–º –≤ –æ—Ç—Ç–æ—á–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–∏–µ, –∞ –≤ —á–µ—Ç–≤–µ—Ä—Ç–æ–º –∫–ª–∞—Å—Ç–µ—Ä–µ —Å –Ω–∏–∑–∫–∏–º –æ—Ç—Ç–æ–∫–æ–º - —Å–∞–º—ã–µ –Ω–∏–∑–∫–∏–µ. –ü–æ—Ö–æ–∂–µ, –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –ª—é–¥—è–º –¥–ª—è —Å—á–∞—Å—Ç—å—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–¥–Ω–æ–≥–æ —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é.
# - 'avg_class_frequency_current_month' (—Å—Ä–µ–¥–Ω—è —á–∞—Å—Ç–æ—Ç–∞ –ø–æ—Å–µ—â–µ–Ω–∏–π –≤ –Ω–µ–¥–µ–ª—é –∑–∞ –ø—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü): —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –ø—É–Ω–∫—Ç—É, –Ω–æ —ç—Ç–æ –∏ –Ω–µ —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ. –ú—ã –ø–æ–º–Ω–∏–º, —á—Ç–æ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –æ—á–µ–Ω—å –≤—ã—Å–æ–∫–∞ (–æ–∫–æ–ª–æ 0.9).
# 
# –í —Ü–µ–ª–æ–º –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –≤—ã–≤–æ–¥—ã:
# - —á–µ–º —Å—Ç–∞—Ä—à–µ –∫–ª–∏–µ–Ω—Ç—ã, —á–µ–º —á–∞—â–µ –æ–Ω–∏ –ø–æ—Å–µ—â–∞—é—Ç –∑–∞–ª –∏ —Ç—Ä–∞—Ç—è—Ç –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥, —Ç–µ–º —Ä–µ–∂–µ –æ–Ω–∏ —É—Ö–æ–¥—è—Ç. –¢–∞–∫–∂–µ –º—É–∂—á–∏–Ω—ã –±–æ–ª–µ–µ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã –∏ –ª–æ—è–ª—å–Ω—ã –∫ –æ–¥–Ω–æ–º—É –º–µ—Å—Ç—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫.
# - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ –Ω–µ –≤–ª–∏—è–µ—Ç –ø—Ä—è–º—ã–º –æ–±—Ä–∞–∑–æ–º –Ω–∞ –æ—Ç—Ç–æ–∫. –ù–æ –º–Ω–æ–≥–∏–µ –ª—é–¥–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –º–µ—Å—è—Ü–∞ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è —Å –¥–∞–ª—å–Ω–µ–π—à–∏–º–∏ –ø–ª–∞–Ω–∞–º–∏ –Ω–∞—Å—á–µ—Ç —Ñ–∏—Ç–Ω–µ—Å —Ü–µ–Ω—Ç—Ä–∞.
# 
# - –≤ –Ω—É–ª–µ–≤–æ–π, "–æ—Ç—Ç–æ—á–Ω—ã–π" –∫–ª–∞—Å—Ç–µ—Ä, –ø–æ–ø–∞–ª–∏ –±–æ–ª—å—à–µ–π —á–∞—Å—Ç—å—é –∂–µ–Ω—â–∏–Ω—ã, —Å —Å–∞–º—ã–º –Ω–∏–∑–∫–∏–º —Å—Ä–µ–¥–Ω–∏–º –≤–æ–∑—Ä–∞—Å—Ç–æ–º (28 –ª–µ—Ç), —Å –º–µ—Å—è—á–Ω—ã–º –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–º (—Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –≤–∑—è—Ç—ã–º "–Ω–∞ –ø—Ä–æ–±—É"), –∏ –ø–æ—Å–µ—â–∞—é—â–∏–µ –∑–∞–ª –æ–∫–æ–ª–æ –¥–≤—É—Ö –º–µ—Å—è—Ü–µ–≤. –ü–æ—Å–µ—â–∞—é—Ç –∑–∞–ª —Ä–µ–¥–∫–æ (1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é). –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, —ç—Ç–æ - –∫–ª–∏–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ–¥—è—Ç –≤ –∑–∞–ª "–æ—Ç –Ω–µ—á–≥–æ –¥–µ–ª–∞—Ç—å" –∏–ª–∏ –ø–æ—Ç–æ–º—É, —á—Ç–æ –≤—Å–µ —Ç–∞–∫ –¥–µ–ª–∞—é—Ç. –ù–∏–∫–∞–∫–∏—Ö —Ü–µ–ª–µ–π –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ø–µ—Ä–µ–¥ —Å–æ–±–æ–π –Ω–µ —Å—Ç–∞–≤—è—â–∏–µ.
# - –≤ –ø–µ—Ä–≤—ã–π, –Ω–∞–∏–±–æ–ª–µ–µ "–ª–æ—è–ª—å–Ω—ã–π" –∫–ª–∞—Å—Ç–µ—Ä –ø–æ–ø–∞–ª–∞ –≥—Ä—É–ø–ø–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤, –≤ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–µ–æ–±–ª–∞–¥–∞—é—Ç –º—É–∂—á–∏–Ω—ã, –¥–∞–≤–Ω–æ –ø–æ—Å–µ—â–∞—é—â–∏–µ –∑–∞–ª (–≤ —Å—Ä–µ–¥–Ω–µ–º –æ–∫–æ–ª–æ 5 –º–µ—Å—è—Ü–µ–≤), —Å –Ω–∞–∏–±–æ–ª–µ–µ –¥–ª–∏—Ç–µ–ª—å–Ω—ã–º –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–º (8 –º–µ—Å—è—Ü–µ–≤ –≤ —Å—Ä–µ–¥–Ω–µ–º), —Å–∞–º—ã–µ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ (30 –ª–µ—Ç), –≥–æ—Ç–æ–≤—ã–µ —Ç—Ä–∞—Ç–∏—Ç—å –±–æ–ª—å—à–∏–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏ –∏ —É—á–∞—Å—Ç–≤—É—é—â–∏–µ –≤ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ.
# - –≤—Ç–æ—Ä–æ–π, "–ª–æ—è–ª—å–Ω—ã–π" –∫–ª–∞—Å—Ç–µ—Ä –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂ –Ω–∞ –ø–µ—Ä–≤—ã–π, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–æ–≥–æ, —á—Ç–æ —ç—Ç–æ –ø–æ –±–æ–ª—å—à–µ–π —á–∞—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç—ã, –ø–æ–ø–∞–≤—à–∏–µ –≤ –∫–ª—É–± –Ω–∞–ø—Ä—è–º—É—é, –ø–æ—ç—Ç–æ–º—É —Å—Ä–æ–∫ –∏—Ö –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ –∫–æ—Ä–æ—Ç–∫–∏–π. –í–æ–∑–º–æ–∂–Ω–æ, –∏–º –≤—ã–≥–æ–¥–Ω–µ–µ –ø—Ä–æ–¥–ª–µ–≤–∞—Ç—å –µ–≥–æ –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü.
# - —Ç—Ä–µ—Ç–∏–π, "–æ—Ç—Ç–æ—á–Ω—ã–π" –∫–ª–∞—Å—Ç–µ—Ä –±–æ–ª—å—à–µ–π —á–∞—Å—Ç—å—é –≤—ã–¥–µ–ª—è–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ –≤—Å–µ –µ–≥–æ –∫–ª–∏–µ–Ω—Ç—ã - –ª—é–¥–∏ –¥–∞–ª–µ–∫–æ –∂–∏–≤—É—â–∏–µ –∏ —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –æ—Ç –∫–ª—É–±–∞. –í —ç—Ç–æ–º –∏ –µ—Å—Ç—å –ø—Ä–∏—á–∏–Ω–∞ –∏—Ö –æ—Ç—Ç–æ–∫–∞. –í—Ä–µ–º—è –Ω–∞ –¥–æ—Ä–æ–≥—É —É–±–∏–≤–∞–µ—Ç –≤—Å–µ –∏–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞.
# - —á–µ—Ç–≤–µ—Ä—Ç—ã–π, "–ª–æ—è–ª—å–Ω—ã–π" –∫–ª–∞—Å—Ç–µ—Ä" —è–≤–ª—è–µ—Ç—Å—è –ø–æ—á—Ç–∏ –±–ª–∏–∑–Ω–µ—Ü–æ–º –ø–µ—Ä–≤–æ–≥–æ, –∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–æ–≥–æ, —á—Ç–æ –∫–æ–Ω—Ç–∏–Ω–≥–µ–Ω—Ç —ç—Ç–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ —Ä–µ–¥–∫–æ –ø–æ—Å–µ—â–∞–µ—Ç –∑–∞–ª. –í–æ–∑–º–æ–∂–Ω–æ, –æ–¥–Ω–æ–≥–æ —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —ç—Ç–∏—Ö –ª—é–¥–µ–π, —Å–ª–∏–∫—à–æ–º –∑–∞–Ω—è—Ç—ã —Å–µ–º—å–µ–π –∏–ª–∏ —Ä–∞–±–æ—Ç–æ–π. –ò–ª–∏ –∞—Ç–ª–µ—Ç—ã –æ—Ç –ø—Ä–∏—Ä–æ–¥—ã.

# #### –†–∞—Å—á–µ—Ç –¥–æ–ª–∏ –æ—Ç—Ç–æ–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞. –û—Ç–ª–∏—á–∞—é—Ç—Å—è –ª–∏ –æ–Ω–∏ –ø–æ –¥–æ–ª–µ –æ—Ç—Ç–æ–∫–∞? –ö–∞–∫–∏–µ –∫–ª–∞—Å—Ç–µ—Ä—ã —Å–∫–ª–æ–Ω–Ω—ã –∫ –æ—Ç—Ç–æ–∫—É, –∞ –∫–∞–∫–∏–µ ‚Äî –Ω–∞–¥—ë–∂–Ω—ã? <a id='step4.6'></a>

# In[29]:


gym_data.groupby('cluster').agg({'churn':'mean'}).reset_index()


# –°–∞–º—ã–µ –Ω–∞–¥–µ–∂–Ω—ã–µ - –ø–µ—Ä–≤—ã–π, –≤—Ç–æ—Ä–æ–π –∏ —á–µ—Ç–≤–µ—Ä—Ç—ã–π –∫–ª–∞—Å—Ç–µ—Ä—ã. –Ø–≤–Ω–æ –æ—Ç—Ç–æ—á–Ω—ã–π - –Ω—É–ª–µ–≤–æ–π, –∫ —Ç–æ–º—É –∂–µ –æ–Ω —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π –ø–æ –æ–±—ä–µ–º—É, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ö–æ—Ä–æ—à–æ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—Ç–æ—á–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤. –¢–∞–∫–∂–µ –æ—Ç—Ç–æ—á–Ω—ã–º –º–æ–∂–Ω–æ –Ω–∞–∑–≤–∞—Ç—å —Ç—Ä–µ—Ç–∏–π –∫–ª–∞—Å—Ç–µ—Ä. –í —Ü–µ–ª–æ–º, –¥–æ–≤–æ–ª—å–Ω–æ —É–¥–∞—á–Ω–∞—è —Ä–∞–∑–±–∏–≤–∫–∞ –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∞–º.

# ### –®–∞–≥ 5. –í—ã–≤–æ–¥—ã –∏ –±–∞–∑–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ <a id='step5'></a>
# [–ö —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é](#contents)

# –í—ã–≤–æ–¥—ã:
# 
# –≤–µ–∑–¥–µ –µ—Å—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –Ω–æ –≤ –æ–±—â–µ–º —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è —Å–ª–µ–¥—É—é—â–∞—è:
# - —á–µ–º —Å—Ç–∞—Ä—à–µ –∫–ª–∏–µ–Ω—Ç—ã, —á–µ–º —á–∞—â–µ –æ–Ω–∏ –ø–æ—Å–µ—â–∞—é—Ç –∑–∞–ª, —Ç—Ä–∞—Ç—è—Ç –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥ –∏ –±–ª–∏–∑–∫–æ –∂–∏–≤—É—Ç/—Ä–∞–±–æ—Ç–∞—é—Ç, —Ç–µ–º —Ä–µ–∂–µ –æ–Ω–∏ —É—Ö–æ–¥—è—Ç. –¢–∞–∫–∂–µ –º—É–∂—á–∏–Ω—ã –±–æ–ª–µ–µ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã –∏ –ª–æ—è–ª—å–Ω—ã –∫ –æ–¥–Ω–æ–º—É –º–µ—Å—Ç—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫.
# - –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å–∫–∏–¥–∫–∏ –¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ —Ñ–∏—Ç–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä–∞ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ "–ø—Ä–∏–≤–µ–¥–∏ –¥—Ä—É–≥–∞" —Ç–∞–∫–∂–µ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –ª–æ—è–ª—å–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤.
# - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ –Ω–µ –≤–ª–∏—è–µ—Ç –ø—Ä—è–º—ã–º –æ–±—Ä–∞–∑–æ–º –Ω–∞ –æ—Ç—Ç–æ–∫. –ù–æ –º–Ω–æ–≥–∏–µ –ª—é–¥–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –º–µ—Å—è—Ü–∞ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è —Å –¥–∞–ª—å–Ω–µ–π—à–∏–º–∏ –ø–ª–∞–Ω–∞–º–∏ –Ω–∞—Å—á–µ—Ç —Ñ–∏—Ç–Ω–µ—Å —Ü–µ–Ω—Ç—Ä–∞.
# 
# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

# - –ú–∞—Ä–µ–∫—Ç–æ–ª–æ–≥–∞–º –¥–ª—è –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Ä—Ç—Ä–µ—Ç –∞—É–¥–∏—Ç–æ—Ä–∏–∏ –ª–æ—è–ª—å–Ω—ã—Ö "—Ö–æ—Ä–æ—à–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤".
# - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã–µ "—Ö–æ—Ä–æ—à–∏–µ –∫–ª–∞—Å—Ç–µ—Ä—ã" –∏ –Ω–∞–π—Ç–∏ –ø—É—Ç–∏ –¥–ª—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –∞—É–¥–∏—Ç–æ—Ä–∏–∏ –∏–∑ –æ—Ç—Ç–æ—á–Ω—ã—Ö. –ö –ø—Ä–∏–º–µ—Ä—É –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∞–∫—Ü–∏–∏ –¥–ª—è –∂–µ–Ω—Å–∫–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏ –∏–ª–∏ –ø—É—Å—Ç–∏—Ç—å —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç –¥–ª—è –¥–∞–ª–µ–∫–æ –∂–∏–≤—É—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (–µ—Å–ª–∏ —Ä–µ—Å—É—Ä—Å—ã —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è—é—Ç).
# - –£–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª-–≤–æ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π. –ò–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä—É –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∑–∞–ª–æ–º. –ù–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Ç–µ—Ö –∏–ª–∏ –∏–Ω—ã—Ö —á–∞—Å—Ç–µ–π —Ü–µ–Ω—Ç—Ä–∞ (–±–∞—Å—Å–µ–π–Ω, –∑–∞–ª –∏ –¥—Ä.).
# - –í–æ–∑–º–æ–∂–Ω–æ, –¥–æ–±–∞–≤–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è, –¥–æ, –∞ –Ω–µ –ø–æ—Å–ª–µ –ø–æ—Ç–µ—Ä–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤. –í–µ—Ä–æ—è—Ç–Ω–æ, –¥–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –æ–±—É—á–µ–Ω–∏—è "–±–µ–∑ —É—á–∏—Ç–µ–ª—è".

# <hr style="border: 2px solid green;" />
# 
# ## –û–±—â–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
# –°–ø–∞—Å–∏–±–æ –∑–∞ –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω—É—é —Ä–∞–±–æ—Ç—Éü§ù
# 
# –í —Ü–µ–ª–æ–º —Ä–∞–±–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Ö–æ—Ä–æ—à–æ. –í–∏–¥–Ω–æ, —á—Ç–æ —Ç—ã –º–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏. –û—Ç–ª–∏—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é.
# 
# –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å**
# - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
# - –º–æ–∂–µ—à—å –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–¥–æ–π—Ç–∏ –∫ –∑–∞–¥–∞—á–µ –ø—Ä–æ—â–µ, –Ω–æ —Å–æ —Å–º—ã—Å–ª–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ–≥–ª–∞—Å–Ω–æ EDA —É–¥–∞–ª–∏—Ç—å —Å–ª–∞–±–æ–≤–ª–∏—è—é—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, –æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ –æ–¥–Ω–æ–º—É –ø—Ä–∏–∑–Ω–∞–∫—É –∏–∑ –ø–∞—Ä—ã —Å —Å–∏–ª—å–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π, –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–µ—Å–ª–∏ –æ–Ω–∏ –±—É–¥—É—Ç —Ä–µ–∞–ª—å–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞–Ω—ã, —Ç–æ –≤–æ–æ–±—â–µ –∫—Ä—É—Ç–æ)) –∏ —Ç–æ–≥–¥–∞ —è —É–≤–µ—Ä–µ–Ω, –º–æ–¥–µ–ª–∏ –±—É–¥—É—Ç —Ö–æ—Ä–æ—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞. –∏ –ø–æ—Ç–æ–º —É–∂–µ –º–æ–∂–Ω–æ –∏—Ö _—Ç—é–Ω–∏–Ω–≥–æ–≤–∞—Ç—å_ —Å –ø–æ–º–æ—â—å—é –ø–æ–∏—Å–∫–∞ –ø–æ —Å–µ—Ç–∫–µ
# 
# –ù–∞ —Å—á–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ - —Å–º—ã—Å–ª –≤ —Ç–æ–º –∏ –µ—Å—Ç—å, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–Ω—É—é –º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–∏–º–µ–Ω—è—Ç—å –µ—ë –Ω–∞ –Ω–æ–≤—ã—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã—Ö. –î–∞ –∫–∞–∫—É—é-—Ç–æ —á–∞—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ –æ–Ω–∞ –Ω–µ –ø–æ–∫—Ä–æ–µ—Ç, –Ω–æ –º—ã –∑–∞—Ä–∞–Ω–µ–µ (–∫–∞–∫ –º–∏–Ω–∏–º—É–º –Ω–∞ 1 –Ω–µ–¥–µ–ª—é) –±—É–¥–µ–º –∑–Ω–∞—Ç—å –∫—Ç–æ –º–æ–∂–µ—Ç —É–π—Ç–∏. –¢–∞–∫–∂–µ –∏–∑ –º–æ–¥–µ–ª–µ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –º–æ–∂–Ω–æ —É–∑–Ω–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –∫–ª–∞—Å—Å, –Ω–æ –∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–¥–Ω–æ—Å—Ç–∏ –∫ –∫–ª–∞—Å—Å—É.
# 
# –ò—Å–ø—Ä–∞–≤–ª—è–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—é –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–π –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—Éüõ†
